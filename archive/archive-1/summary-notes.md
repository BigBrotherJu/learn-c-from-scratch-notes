# 总结

## Syntax and semantics

https://www.geeksforgeeks.org/difference-between-syntax-and-semantics/

https://stackoverflow.com/questions/17930267/what-is-the-difference-between-syntax-and-semantics-in-programming-languages

# 源代码的组成

## 预处理指示

- `#include <Header File>`

  单独占一行。

- `define 标识符 常量`

- `define` 宏

## 声明（Declaration）

声明和语句类似，也是以 `;` 号结尾的，但是在语法上声明和语句是有区别的，语句只能出现在 `{}` 括号中，而声明既可以出现在 `{}` 中也可以出现在所有 `{}` 之外。

### 变量声明

```
变量声明 → 类型 标识符 = Initializer, 标识符 = Initializer, ...;
（= Initializer 的部分可以不写）
```

- 初始化（Initialization）

  局部变量可以用类型相符的任意表达式来初始化，而全局变量只能用常量表达式（Constant Expression）初始化。

  如果全局变量在定义时不初始化则初始值是 0，如果局部变量在定义时不初始化则初始值是不确定的。

- 结构体变量

  见 结构体。

### 函数声明

```
非定义的函数声明 → 返回值类型 函数名(参数列表);
```

### 类型声明

见 结构体。

## 函数定义

```
函数定义 → 返回值类型 函数名(参数列表) 函数体
函数体 → { 语句列表 }
语句列表 → 语句列表项 语句列表项 ...
语句列表项 → 语句
语句列表项 → 变量声明、类型声明或非定义的函数声明
非定义的函数声明 → 返回值类型 函数名(参数列表);
```

### 声明

在函数体中的声明只有局部作用域。

### 语句（Statement）

#### 表达式（Expression）语句

表达式加 `;` 就是语句，这样的语句被称为表达式语句。

- 表达式的基本属性

  一个表达式的值的最小存储单位是字节（Byte），不同类型的表达式的值占的字节数不同。

  - 值（Value）

  - 类型（Type）

    - 标量类型（Scalar Type）

      可以表示零和非零，可以参与逻辑与、或、非运算或者做控制表达式的类型。

      - 算数类型（Arithmetic Type）

        可以做算术运算的类型称为算术类型。

        - 整数类型（Integer Type）

          - 字符类型（Character Type） `char` 1 字节
          - `int` x 字节
          - 布尔类型（Boolean Type）非 0 表示真，0 表示假
          - 枚举类型

        - 浮点数类型（Floating Point Type）

          - 单精度浮点数类型 `float` x 字节
          - 双精度浮点数类型 `double` x 字节
          - 更高精度浮点数类型 `long double` x 字节

      - 指针类型

    - 函数类型（Function Type) x 字节

- 基础表达式

  - 标识符（Identifier）

    - 变量名

    - 函数名（Function Designator）

      函数名的类型是函数类型（Function Type）。

    - 成员变量

  - 常量（Constant)

    - 正常小数 `3.14` 的类型是 `double`

  - 字符串字面值（String Literal）

    字符串字面值的类型...

- 复合表达式

  复合表达式由运算符和基础表达式/复合表达式组成。

  - 运算符

    - 运算符（Operator）和操作数（Operand）

      被运算符（Operator）操作（Operate）的就叫操作数（Operand）。

    - 运算符种类

      - `+` `-` `*` `/` 算数（Arithmetic）运算符

        `1+1`、`hour-1`、`hour * 60`、`minute/60`

        算数表达式的值和类型。。。

        两个 `int` 相除还是 `int`，结果小数部分要截掉。

      - `%` 取模（Modulo）运算符

        表达式的类型是整型，值的符号和被除数一样。

        `%` 运算符的两个操作数必须是整型的。

      - `=` 赋值（Assignment）运算符

        `lvalue = rvalue`

        赋值表达式的值和类型就是等号右边表达式的值和类型。

        在等号左边的表达式必须能表达存储位置。

        能做左值的表达式有：

        - 变量名

        不能做左值的表达式有：

        - 函数调用表达式

      - `()` 函数调用（Function Call）运算符

        `Function Designator(Expression1, Expression2, ...)`

        函数调用表达式的值和类型就是函数最后返回的表达式的值和类型。

      - `>` `>=` `<` `<=` 关系（Relational）运算符

      - `==` `!=` 相等性（Equality）运算符

      - `&&` `||` `!` 逻辑（Logical）运算符

        控制表达式（Controlling Expression）的类型是 `int`。

        表达控制式可以是任意 `int` 型表达式；还可以由上面六个关系相等性运算符之一和两个操作数组成，值为 1 或 0；还可以通过逻辑运算符组成，值为 1 或 0。

        关系运算符和相等性运算符的操作数要是同类型的，两边都是整型或者都是浮点型可以做比较，但两个字符串不能做比较。

      - `++` `--`

        前缀和后缀 `++` `--` 要求操作数能做左值。

    - 运算符优先级（Precedence）（高在上）和结合性（Associativity）

      优先级：后缀运算符 > 前缀运算符 > 其他运算符

      - `++` `--` `.` `[]` `()` 左结合

      - `!` `+` `-` `++` `--` 右结合

      - `*` `/` `%` 左结合

      - `+` `-` 左结合

      - `>` `>=` `<` `<=` 左结合

      - `==` `!=` 左结合

      - `&&` 左结合

      - `||` 左结合

      - `=` 右结合

#### 语句块（Statement Block）

语句块也是一种语句。

语句块是由 `{}` 括起来的若干条语句或声明。

语句块和函数体的语法相同。语句块中也可以定义局部变量。

#### 空语句（Null Statement）

#### break 语句

break 语句只出现在 switch 语句块和循环体中。

#### continue 语句

continue 语句只出现在循环体中。

#### goto 语句

```
goto Label;
```

#### 标号（Label）语句

任何语句前面都可以加一个或几个标号。

`case 整型常量表达式` 和 `default` 也是特殊标号。

#### 分支语句（Selection Statement）

- if/else 语句

  ```
  if (控制表达式) 语句
  else 语句
  ```

  `else` 子句（Clause）可以省略。

  上面的语句可以是所有种类的语句，包括语句块、空语句与 if/else 语句。

- switch 语句

  ```
  switch (控制表达式) {
  case 整型常量表达式： 语句列表
  case 整型常量表达式： 语句列表
  ...
  }
  ```

  各 case 的整型常量表达式必须不同。

  default 可以没有。

  break 语句可以没有。

  因为 `case 整型常量表达式` 和 `default` 也是特殊标号，所以括号里的语句都可以当成正常语句对待。

#### 循环语句（Loop Statement)

- while 语句

  ```
  while (控制表达式) 语句
  ```

  上面的语句可以是所有种类的语句，包括语句块、空语句。

- do/while 语句

  ```
  do 语句 while (控制表达式);
  ```

- for 语句

  ```
  for (表达式1; 控制表达式2; 表达式3) 语句
  ```

  `表达式1;` 可以是变量初始化。

  上面的语句可以是所有种类的语句，包括语句块、空语句与循环语句。

#### return 语句

return 语句只能用在函数定义中。

# 结构体

## 声明 Tag

```
struct Tag {
  类型 标识符, 标识符, ...；
  类型 标识符, 标识符, ...；
  ...
};
```

## 结构体变量

### 定义结构体变量

- 一边声明 Tag 一边定义变量

  ```
  struct Tag {
    类型 标识符, 标识符, ...；
    类型 标识符, 标识符, ...；
    ...
  } 标识符, 标识符, ...;
  ```

- Tag 已经声明好了

  ```
  struct Tag 标识符, 标识符, ...;
  ```

- 不声明 Tag 直接定义变量

  ```
  struct {
    类型 标识符, 标识符, ...；
    类型 标识符, 标识符, ...；
    ...
  } 标识符, 标识符, ...;
  ```

#### 初始化

如果结构体变量是全局变量，只能用常量表达式初始化；如果结构体变量是局部变量，可以用含变量名的表达式初始化。（C99 新特性）

不管结构体变量是全局变量还是局部变量，都只能用常量表达式初始化。（C89 特性）

- 正常初始化

  ```
  { Initializer1, Initializer2, ... }
  ```

  Initializer 中的数据依次赋给结构体的各成员。

  如果 Initializer 中的数据比结构体的成员多，编译器会报错，但如果只是末尾多个逗号则不算错。

  如果 Initializer 中的数据比结构体的成员少，未指定的成员将用 0 来初始化，就像未初始化的全局变量一样。

- Designated-Initializer C99 新特性

  ```
  { .标识符 = Intializer, .标识符 = Intializer, ... }
  ```

  有些时候结构体中只有某一个或某几个成员需要初始化，其它成员都用 0 初始化即可，用 Designated Initializer 语法可以针对每个成员做初始化（Memberwise Initialization），很方便。

- 可以用一个结构体变量初始化另一个结构体变量

  ```
  struct Tag z2 = z1;
  ```

  z2 必须是局部变量才能用变量 z1 的值来初始化。

### 给结构体变量赋值

- `x = {...}`

  不能这么赋。

- `x = (struct Tag){...}` C99 新特性

  可以这么赋。

- `z1 = z2`

  可以用一个结构体变量给另一个结构体变量赋值。

## 成员变量

- 成员变量被赋值

  `x.y = 表达式;`

  `x.y` 能不能做左值取决于 x 能不能做左值。

- 访问成员变量的值

  `x.y`

# 标识符

- 变量名
  - 参数
- 函数名（Function Designator）
- 宏定义
- 标号
- Tag
  - 结构体成员名

# Shell

## 特殊变量

`$?` 是 Shell 中的一个特殊变量，表示上一条命令的退出状态。